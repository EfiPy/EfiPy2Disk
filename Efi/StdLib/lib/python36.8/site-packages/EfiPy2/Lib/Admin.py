#
# Admin.py
#
# Copyright (C) 2026 efipy.core@gmail.com All rights reserved.
#

import os, sys

if   os.name == 'posix':

    def IsAdmin():
        return os.getuid() == 0

    def ForkToAdmin ():
        if IsAdmin():
            return True
        command = ['sudo', 'python'] + sys.argv[:]
        import subprocess
        process = subprocess.run(command)
        sys.exit(0)

elif os.name == 'nt':

    def IsAdmin():
        import ctypes
        return ctypes.windll.shell32.IsUserAnAdmin() != 0

    def ForkToAdmin ():
        if IsAdmin():
            return True
        import sys, ctypes
        ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, " ".join(sys.argv), None, 1)
        sys.exit(0)

elif os.name == 'edk2':

    def IsAdmin():
        return True

    def ForkToAdmin ():
        return True

else:

    def IsAdmin():
        return True

    def ForkToAdmin ():
        return True

if __name__ == '__main__':
    ForkToAdmin ()
    if IsAdmin ():
        input ('We are in Admin mode')